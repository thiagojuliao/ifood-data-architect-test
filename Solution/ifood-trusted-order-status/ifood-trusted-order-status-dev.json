{"paragraphs":[{"text":"%pyspark\n\n###############################################\n#   Importando pacotes & definindo funções    #\n###############################################\n\nfrom datetime import *\nfrom pyspark import StorageLevel\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.types import *\n\n###############################\n#   Definição de variáveis    #\n###############################\n\n# Caminho de origem da raw order status\norigem_raw = \"hdfs://localhost:9000/ifood-raw-order-status/\"\n\n# Caminho de destino da trusted order status\ndestino_trusted = \"hdfs://localhost:9000/ifood-trusted-order-status/\"\n\n# Inicia sessão spark\nspark = SparkSession.builder.appName(\"ifood-trusted-order-status-dev\").getOrCreate()\n\n# Configurações básicas para o spark\nspark.conf.set(\"spark.sql.maxPartitionBytes\", 200 * 1024 * 1024) # Seta a quantidade máxima de bytes em uma partição ao ler os arquivos de entrada (Entre 100MB e 200MB é o ideal)\nspark.conf.set(\"spark.sql.sources.partitionOverwriteMode\", \"DYNAMIC\") # Necessário para sobrescrever partições","user":"anonymous","dateUpdated":"2019-12-25T09:44:07-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1577277347749_382731406","id":"20191223-012630_1390010523","dateCreated":"2019-12-25T09:35:47-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:370","dateFinished":"2019-12-25T09:44:07-0300","dateStarted":"2019-12-25T09:44:07-0300"},{"title":"Lê a origem","text":"%pyspark\n\n# Lê a base raw order status\nrawDF = spark.read.parquet(origem_raw).persist(StorageLevel.DISK_ONLY)\nprint(\"> Volumetria da raw order status: {}\".format(rawDF.count()))\nrawDF.show(5, False)","user":"anonymous","dateUpdated":"2019-12-25T10:11:23-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"> Volumetria da raw order status: 7340326\n+------------------------+------------------------------------+------------------------------------+----------+----------+----------+\n|created_at              |order_id                            |status_id                           |value     |dt_proc   |dt        |\n+------------------------+------------------------------------+------------------------------------+----------+----------+----------+\n|2019-01-29T17:40:10.000Z|0077de01-aa01-4eea-8b93-914cc93aca76|f2b5f85e-ad54-40da-8612-5f46ed2b934b|CONCLUDED |2019-12-24|2019-01-29|\n|2019-01-29T15:36:20.000Z|0077de01-aa01-4eea-8b93-914cc93aca76|0d5db16c-e264-4308-8fc9-076d125ab64a|PLACED    |2019-12-24|2019-01-29|\n|2019-01-29T15:36:19.000Z|0077de01-aa01-4eea-8b93-914cc93aca76|b58d5fa6-575c-4861-b9a2-3cf5f19db9da|REGISTERED|2019-12-24|2019-01-29|\n|2019-01-29T15:40:02.000Z|0136a355-0eb8-41f2-b197-c9520e044db1|ba4e4937-1499-4efd-a874-3c0e3f86b727|PLACED    |2019-12-24|2019-01-29|\n|2019-01-29T15:40:01.000Z|0136a355-0eb8-41f2-b197-c9520e044db1|b31ffd60-ced1-4144-97c6-c882d822bfe7|REGISTERED|2019-12-24|2019-01-29|\n+------------------------+------------------------------------+------------------------------------+----------+----------+----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1577277347762_-977174670","id":"20191223-012858_808752653","dateCreated":"2019-12-25T09:35:47-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:371","dateFinished":"2019-12-25T10:12:56-0300","dateStarted":"2019-12-25T10:11:23-0300"},{"text":"%pyspark\n\nrawDF.filter(col(\"order_id\") == \"fa4427f7-0436-4470-8623-bd3010ce9cbd\").withColumn(\"created_at_\", col(\"created_at\").cast(TimestampType())).show(5, False)","user":"anonymous","dateUpdated":"2019-12-25T10:05:17-0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1577278807470_-569102810","id":"20191225-100007_848975966","dateCreated":"2019-12-25T10:00:07-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1483","dateFinished":"2019-12-25T10:05:25-0300","dateStarted":"2019-12-25T10:05:17-0300","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------+------------------------------------+------------------------------------+----------+----------+----------+-------------------+\n|created_at              |order_id                            |status_id                           |value     |dt_proc   |dt        |created_at_        |\n+------------------------+------------------------------------+------------------------------------+----------+----------+----------+-------------------+\n|2019-01-22T02:00:10.000Z|fa4427f7-0436-4470-8623-bd3010ce9cbd|6e2dd5d7-455c-48b2-bd05-81f1992ddffc|CONCLUDED |2019-12-24|2019-01-22|2019-01-22 00:00:10|\n|2019-01-22T00:00:02.000Z|fa4427f7-0436-4470-8623-bd3010ce9cbd|5f5d7996-51b3-47e3-b673-87633c293eda|PLACED    |2019-12-24|2019-01-22|2019-01-21 22:00:02|\n|2019-01-22T00:00:01.000Z|fa4427f7-0436-4470-8623-bd3010ce9cbd|3d752aa5-9f69-4593-820b-cb0892bce05b|REGISTERED|2019-12-24|2019-01-22|2019-01-21 22:00:01|\n+------------------------+------------------------------------+------------------------------------+----------+----------+----------+-------------------+\n\n"}]}},{"text":"%pyspark\n\n# Domínio da coluna value\nrawDF.select(\"value\").dropDuplicates().show(20, False)","user":"anonymous","dateUpdated":"2019-12-25T09:35:47-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|value     |\n+----------+\n|CONCLUDED |\n|REGISTERED|\n|CANCELLED |\n|PLACED    |\n+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1577277347765_1353776859","id":"20191223-013645_111599159","dateCreated":"2019-12-25T09:35:47-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:372"},{"text":"%pyspark\n\n# Trabalhando com conversões timestamp -> unix_timestamp e vice-versa\nrawDF \\\n    .withColumn(\"created_at\", col(\"created_at\").cast(TimestampType())) \\\n    .withColumn(\"created_at\", unix_timestamp(\"created_at\")) \\\n    .withColumn(\"created_at\", to_timestamp(\"created_at\")) \\\n    .show()","user":"anonymous","dateUpdated":"2019-12-25T09:35:47-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+--------------------+--------------------+----------+----------+----------+\n|         created_at|            order_id|           status_id|     value|   dt_proc|        dt|\n+-------------------+--------------------+--------------------+----------+----------+----------+\n|2019-01-29 06:25:06|0115a7f2-be83-426...|0dd973d0-699c-4f8...| CONCLUDED|2019-12-23|2019-01-29|\n|2019-01-29 04:25:00|0115a7f2-be83-426...|433e73d7-038c-497...|REGISTERED|2019-12-23|2019-01-29|\n|2019-01-29 04:25:01|0115a7f2-be83-426...|bf1ff246-e7cb-45b...|    PLACED|2019-12-23|2019-01-29|\n|2019-01-29 15:07:55|019c3f5a-8eac-4a1...|527ecc08-61a1-446...|REGISTERED|2019-12-23|2019-01-29|\n|2019-01-29 17:10:10|019c3f5a-8eac-4a1...|ed9c0e40-5347-467...| CONCLUDED|2019-12-23|2019-01-29|\n|2019-01-29 15:07:56|019c3f5a-8eac-4a1...|c1d41128-565d-4df...|    PLACED|2019-12-23|2019-01-29|\n|2019-01-29 00:49:44|01e535f7-3922-458...|9a2b75d7-0c71-44e...|    PLACED|2019-12-23|2019-01-29|\n|2019-01-29 00:49:43|01e535f7-3922-458...|5c877a80-365e-403...|REGISTERED|2019-12-23|2019-01-29|\n|2019-01-29 02:50:04|01e535f7-3922-458...|7e71f1c2-1ecd-4b7...| CONCLUDED|2019-12-23|2019-01-29|\n|2019-01-29 21:25:23|02d58f4b-88b6-490...|53f3b8c1-0748-46d...|    PLACED|2019-12-23|2019-01-29|\n|2019-01-29 23:30:05|02d58f4b-88b6-490...|769932c7-c35b-438...| CONCLUDED|2019-12-23|2019-01-29|\n|2019-01-29 21:25:22|02d58f4b-88b6-490...|e94a1a6d-ad83-451...|REGISTERED|2019-12-23|2019-01-29|\n|2019-01-29 23:50:07|03672967-fd70-471...|6979e6c0-056b-4b9...| CONCLUDED|2019-12-23|2019-01-29|\n|2019-01-29 21:48:39|03672967-fd70-471...|96e421ad-2fb4-469...|    PLACED|2019-12-23|2019-01-29|\n|2019-01-29 21:48:38|03672967-fd70-471...|3c8f163a-3d37-497...|REGISTERED|2019-12-23|2019-01-29|\n|2019-01-30 00:20:08|0404790f-017a-4ae...|2648a9c2-bb10-4f1...| CONCLUDED|2019-12-23|2019-01-29|\n|2019-01-29 22:15:22|0404790f-017a-4ae...|13eaf495-fd3b-49e...|REGISTERED|2019-12-23|2019-01-29|\n|2019-01-29 22:15:23|0404790f-017a-4ae...|046f430f-1139-42a...|    PLACED|2019-12-23|2019-01-29|\n|2019-01-29 22:32:31|044769cf-6884-4d3...|b11dca27-d079-48c...|    PLACED|2019-12-23|2019-01-29|\n|2019-01-29 22:32:30|044769cf-6884-4d3...|1737139d-7217-47d...|REGISTERED|2019-12-23|2019-01-29|\n+-------------------+--------------------+--------------------+----------+----------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1577277347768_-1506996845","id":"20191223-014335_43697411","dateCreated":"2019-12-25T09:35:47-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:373"},{"title":"Pivoteia a tabela","text":"%pyspark\n\n# Pivoteia a tabela a fim de termos os valores dos status de cada ordem em colunas distintas\npivotDF = rawDF \\\n    .drop(\"dt_proc\") \\\n    .withColumn(\"created_at\", col(\"created_at\").cast(TimestampType())) \\\n    .withColumn(\"created_at\", unix_timestamp(\"created_at\")) \\\n    .groupBy(\"order_id\", \"dt\") \\\n    .pivot(\"value\", [\"REGISTERED\", \"PLACED\", \"CONCLUDED\", \"CANCELLED\"]) \\\n    .min(\"created_at\") \\\n    .withColumn(\"registered\", to_timestamp(\"REGISTERED\")) \\\n    .withColumn(\"placed\", to_timestamp(\"PLACED\")) \\\n    .withColumn(\"concluded\", to_timestamp(\"CONCLUDED\")) \\\n    .withColumn(\"cancelled\", to_timestamp(\"CANCELLED\")) \\\n    .withColumn(\"dt_proc\", current_date())\n    \npivotDF.show(5, False)","user":"anonymous","dateUpdated":"2019-12-25T10:13:09-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------------+----------+-------------------+-------------------+-------------------+---------+----------+\n|order_id                            |dt        |registered         |placed             |concluded          |cancelled|dt_proc   |\n+------------------------------------+----------+-------------------+-------------------+-------------------+---------+----------+\n|293ecd11-85f9-4725-889a-ac29fd0575c0|2019-01-29|2019-01-29 19:16:36|2019-01-29 19:16:37|2019-01-29 21:20:04|null     |2019-12-25|\n|8cdda684-f2e7-4ec3-8664-57a7e57d7d96|2019-01-29|2019-01-29 21:16:15|2019-01-29 21:16:16|2019-01-29 23:20:09|null     |2019-12-25|\n|dbac863a-97ef-4dcd-b63a-5688936d26f9|2019-01-29|2019-01-29 21:11:03|2019-01-29 21:11:04|2019-01-29 23:15:03|null     |2019-12-25|\n|82ac103b-5465-4444-b4c7-69c972dfa933|2019-01-29|2019-01-29 21:44:39|2019-01-29 21:44:40|2019-01-29 23:45:06|null     |2019-12-25|\n|fa4427f7-0436-4470-8623-bd3010ce9cbd|2019-01-22|2019-01-21 22:00:01|2019-01-21 22:00:02|2019-01-22 00:00:10|null     |2019-12-25|\n+------------------------------------+----------+-------------------+-------------------+-------------------+---------+----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1577277347772_1035120728","id":"20191223-013047_257641669","dateCreated":"2019-12-25T09:35:47-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:374","dateFinished":"2019-12-25T10:15:59-0300","dateStarted":"2019-12-25T10:13:09-0300"},{"title":"Testa a veracidade da informação","text":"%pyspark\n\nrawDF.filter(col(\"order_id\") == \"1c97019e-f812-4798-80c6-7aeb81be4c25\").show(5, False)","user":"anonymous","dateUpdated":"2019-12-25T09:35:47-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------+------------------------------------+------------------------------------+----------+----------+----------+\n|created_at              |order_id                            |status_id                           |value     |dt_proc   |dt        |\n+------------------------+------------------------------------+------------------------------------+----------+----------+----------+\n|2019-01-23T15:27:19.000Z|1c97019e-f812-4798-80c6-7aeb81be4c25|d99a0e7e-906f-462b-aa82-a659ac605b8f|REGISTERED|2019-12-23|2019-01-23|\n|2019-01-23T17:30:06.000Z|1c97019e-f812-4798-80c6-7aeb81be4c25|c7e6a3a6-199a-4129-9f94-430a0b6325d7|CONCLUDED |2019-12-23|2019-01-23|\n|2019-01-23T15:27:20.000Z|1c97019e-f812-4798-80c6-7aeb81be4c25|ec1399dc-c511-4bea-a28d-53ce1a6b8e96|PLACED    |2019-12-23|2019-01-23|\n+------------------------+------------------------------------+------------------------------------+----------+----------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1577277347774_827327786","id":"20191223-013831_1971078754","dateCreated":"2019-12-25T09:35:47-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:375"},{"text":"%pyspark\n\npivotDF.printSchema()","user":"anonymous","dateUpdated":"2019-12-25T10:16:12-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- order_id: string (nullable = true)\n |-- dt: date (nullable = true)\n |-- registered: timestamp (nullable = true)\n |-- placed: timestamp (nullable = true)\n |-- concluded: timestamp (nullable = true)\n |-- cancelled: timestamp (nullable = true)\n |-- dt_proc: date (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1577277347775_-1504526129","id":"20191223-020704_1153229193","dateCreated":"2019-12-25T09:35:47-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:376","dateFinished":"2019-12-25T10:16:12-0300","dateStarted":"2019-12-25T10:16:12-0300"},{"text":"%pyspark\n\npivotDF \\\n    .write.mode(\"overwrite\") \\\n    .partitionBy(\"dt\") \\\n    .option(\"compression\", \"snappy\") \\\n    .format(\"parquet\") \\\n    .save(destino_trusted)","user":"anonymous","dateUpdated":"2019-12-25T10:19:25-0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1577279864382_-938455432","id":"20191225-101744_494962004","dateCreated":"2019-12-25T10:17:44-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1840","dateFinished":"2019-12-25T10:36:35-0300","dateStarted":"2019-12-25T10:19:25-0300","title":"Grava no diretório final","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\nrawDF.unpersist()","user":"anonymous","dateUpdated":"2019-12-25T10:19:23-0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1577279949671_-452715116","id":"20191225-101909_1798049111","dateCreated":"2019-12-25T10:19:09-0300","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1945"},{"title":"Grava no diretório final","text":"%pyspark\n\n# Grava a tabela no diretório final\n# 125MB correspondem a aproximadamente 2.400.000 linhas\nnum_de_linhas = pivotDF.count()\ntotal_de_particoes = num_de_linhas / 2400000\n\npivotDF \\\n    .repartition(total_de_particoes) \\\n    .write.mode(\"overwrite\") \\\n    .partitionBy(\"dt\") \\\n    .option(\"compression\", \"snappy\") \\\n    .format(\"parquet\") \\\n    .save(destino_trusted)","user":"anonymous","dateUpdated":"2019-12-25T10:17:51-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1577277347779_-218116427","id":"20191223-014952_2099873042","dateCreated":"2019-12-25T09:35:47-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:377"},{"title":"Validação","text":"%pyspark\n\n# Leitura da base final\ntrustedDF = spark.read.parquet(destino_trusted) \\\n    .select(\n        \"order_id\", \n        expr(\"registered as registered_\"), \n        expr(\"placed as placed_\"), \n        expr(\"concluded as concluded_\"), \n        expr(\"cancelled as cancelled_\")) \\\n    .orderBy(\"order_id\")\n\n# Monta a tabela comparativa\ncompDF = rawDF \\\n    .groupBy(\"order_id\", \"value\") \\\n    .agg(min(\"created_at\").alias(\"created_at\")) \\\n    .withColumn(\"registered\", expr(\"case when value == 'REGISTERED' then created_at else null end\")) \\\n    .withColumn(\"placed\", expr(\"case when value == 'PLACED' then created_at else null end\")) \\\n    .withColumn(\"concluded\", expr(\"case when value == 'CONCLUDED' then created_at else null end\")) \\\n    .withColumn(\"cancelled\", expr(\"case when value == 'CANCELLED' then created_at else null end\")) \\\n    .withColumn(\"registered\", col(\"registered\").cast(TimestampType())) \\\n    .withColumn(\"placed\", col(\"placed\").cast(TimestampType())) \\\n    .withColumn(\"concluded\", col(\"concluded\").cast(TimestampType())) \\\n    .withColumn(\"cancelled\", col(\"cancelled\").cast(TimestampType())) \\\n    .drop(\"value\") \\\n    .orderBy(\"order_id\") \n\n#compDF.show(5, False)\n\n# Compara as variáveis e valida os resultados\nvalidaDF = compDF \\\n    .join(trustedDF, on=[\"order_id\"], how=\"left\") \\\n    .withColumn(\"fl_registered\", expr(\"case when coalesce(registered, registered_, '9999-12-31 00:00:00') = coalesce(registered_, '9999-12-31 00:00:00') then 0 else 1 end\")) \\\n    .withColumn(\"fl_placed\", expr(\"case when coalesce(placed, placed_, '9999-12-31 00:00:00') = coalesce(placed_, '9999-12-31 00:00:00') then 0 else 1 end\")) \\\n    .withColumn(\"fl_concluded\", expr(\"case when coalesce(concluded, concluded_, '9999-12-31 00:00:00') = coalesce(concluded_, '9999-12-31 00:00:00') then 0 else 1 end\")) \\\n    .withColumn(\"fl_cancelled\", expr(\"case when coalesce(cancelled, cancelled_, '9999-12-31 00:00:00')  = coalesce(cancelled_, '9999-12-31 00:00:00') then 0 else 1 end\"))\n\n# Faz a contagem de valores desiguais\nerrosDF = validaDF \\\n    .withColumn(\"dummy\", lit(\"1\")) \\\n    .groupBy(\"dummy\") \\\n    .agg(\n        sum(\"fl_registered\").alias(\"err_registered\"),\n        sum(\"fl_placed\").alias(\"err_placed\"),\n        sum(\"fl_concluded\").alias(\"err_concluded\"),\n        sum(\"fl_cancelled\").alias(\"err_cancelled\")) \\\n    .withColumn(\"total\", col(\"err_registered\") + col(\"err_placed\") + col(\"err_concluded\") + col(\"err_cancelled\"))\n\ntotal_de_erros = errosDF.select(\"total\").take(1)[0][\"total\"]\n\nprint(\"> Total de valores desiguais confirmados: {}\".format(total_de_erros))","user":"anonymous","dateUpdated":"2019-12-25T09:35:47-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"> Total de valores desiguais confirmados: 0\n"}]},"apps":[],"jobName":"paragraph_1577277347780_-135403519","id":"20191223-020948_1107924447","dateCreated":"2019-12-25T09:35:47-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:378"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-12-25T09:35:47-0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1577277347784_901044731","id":"20191223-041847_483506837","dateCreated":"2019-12-25T09:35:47-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:379"}],"name":"ifood-trusted-order-status-dev","id":"2EW6VMUHC","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}